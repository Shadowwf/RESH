# RESH
 A Robust and Efficient Similarity Search Index for High-Dimensional Metric Space

With the exponential growth of multi-modal data and the increasing dimensionality of embedding models, the exorbitant costs associated with precise similarity search in high-dimensional metric spaces have become prohibitive for many data analysis tasks. Approximate Nearest Neighbor (ANN) search, which enables rapid and accurate similarity retrieval by constructing indexes for high-dimensional vector data, has consequently garnered significant attention in recent years. However, existing index methods currently exhibit instability under diverse ANN query workloads. Specifically, for query loads concentrated in certain specialized regions of the high-dimensional space, current methods face trade-offs between computational cost and query recall. This paper identifies the causes of such instabilities and introduces RESH, a novel learned metric index. RESH achieves robust and efficient ANN search through the integration of soft clustering, neural network, and approximate proximity graph. In RESH, data are initially partitioned into multiple clusters. A neural network is then employed to predict the clusters to which the nearest neighbor objects of the query load belong. To address the instability in ANN search performance observed in existing methods, RESH incorporates a data filtering mechanism that excludes data points adversely affecting search time and recall rate from the high-dimensional space while maintaining an additional approximate proximity graph. During the search phase, RESH accesses a limited number of clusters and retrieves candidate objects from the approximate proximity graph. Extensive experiments conducted on vector database show that RESH outperforms state-of-the-art high-dimensional index methods by providing stable and superior ANN recall rates under comparable or more stringent time constraints. The code of RESH is available on GitHub.
